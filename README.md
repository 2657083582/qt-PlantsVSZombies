### 基于C++和QML的植物大战僵尸

#### 一、项目目标
利用QML与C++混合编程实现植物大战僵尸，最终效果尽可能与原版植物大战僵尸达到一致

#### 二、设计思路
1、利用QMl实现界面，用C++管理数据
2、游戏界面主要包括植物、僵尸、铲子、除草机、商店等

#### 三、界面设计
本项目本着还原植物大战僵尸的目的，游戏界面模仿植物大战僵尸游戏界面：最上方是卡牌商店，商店右边是铲子，右上角是暂停继续按钮，界面中央是地图，植物和僵尸在此展开战斗，地图左边是割草机。
游戏场景中的静态物体通过QML中的Image绘制，动态物体通过AnimatedImage绘制，而僵尸的移动、子弹的移动主要通过NumberAnimation实现。

#### 四、植物设计
主要property：
name:植物名称，可根据名称来获得相应行为
hp:血量，用于判断植物是否死亡
canShot:判断该植物是否能射击
state:植物当前状态（主要用于坚果墙等有状态显示变化的植物）

#### 五、僵尸设计
主要property
hp:血量，用于判断僵尸是否死亡
state:僵尸状态（不同僵尸有不同的状态，但所有僵尸都有初始（血量较高）状态、残血（血量较低）状态、死亡状态）

#### 六、操作方式
1、选择植物：点击植物卡片选中，再次点击则取消选中
2、种植植物：点击界面上方植物卡片，再点击中央地图对应的位置进行种植
3、铲除植物：点击右上角铲子选中，再点击对应植物铲除

#### 七、运行效果
1、主菜单界面
![](/root/study/qt/qt-PlantsVSZombies/主菜单界面.png)

2、植物选取界面
![](/root/study/qt/qt-PlantsVSZombies/植物选取界面.png)

3、游戏界面
![](/root/study/qt/qt-PlantsVSZombies/游戏界面.png)

4、游戏结束
![](/root/study/qt/qt-PlantsVSZombies/游戏结束.png)

#### 八、存在的问题
1、碰撞检测存在延时问题：我们是利用定时器，按一个较小的时间间隔进行碰撞检测，因此难免存在误差延时。
2、部分植物和僵尸的功能还未实现，例如樱桃炸弹，它是一个范围爆炸伤害，但我们较难获取该范围内的僵尸的信息，因此对于樱桃炸弹的爆炸对僵尸造成伤害目前难以实现。
3、僵尸状态改变问题：当僵尸血量较少时会有一个失去手臂的状态，但是我们暂时没有找到相应资源，因此这个状态的改变尚未实现。
4、数组越界问题：对于游戏场景中的植物、僵尸、子弹等对象，我们为了方便管理，将它们放入了容器中，但是在创建销毁这些对象时，出于某些原因（目前还未找到具体原因）导致数组越界，甚至导致程序崩溃，因此这是一个急需解决的根本问题。
